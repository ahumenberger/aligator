WHILE[( d>= E),
	IF[(P< a+b),
        b:=b/2;
        d:=d/2,
        a:=a+b;
        y:=y+d/2;
        b:=b/2;
        d:=d/2;
    ]
]



